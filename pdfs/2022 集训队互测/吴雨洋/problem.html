<h1 id="匹配计数"><a href="#匹配计数" class="headerlink" title="匹配计数"></a>匹配计数</h1><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>给定正整数 $n$ 以及正整数序列 $a_1,a_2,\cdots, a_n$，其中 $a_i$ 表示第 $i$ 个点的颜色。求同时满足如下条件的大小为 $n$ 的简单无向图 $G$ 的个数：</p>
<ol>
<li><p>边之间没有公共端点。即 $G$ 是一匹配。</p>
</li>
<li><p>对于任一条边它的两个端点的颜色相同。</p>
</li>
<li><p>对两条不同的边 $e_1=(u_1,v_1) (u_1&lt; v_1)$ 与 $e_2=(u_2,v_2) (u_2&lt; v_2)$，若 $u_1&lt; u_2&lt; v_1&lt; v_2$ 或 $u_2&lt; u_1&lt; v_2&lt; v_1$ 则称 $e_1$ 与 $e_2$ 相交。满足 $e_1$ 与 $e_2$ 相交的无序对 $(e_1,e_2)$ 有偶数个。</p>
</li>
</ol>
<p>由于答案可能很大，对 $998244353$ 取模。每个数据点有 $T$ 组数据。</p>
<h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行输入一个正整数 $T$。接下来紧跟着 $T$ 组数据，两组数据之间会换一行。</p>
<p>每组数据的第一行是一个正整数 $n$，第二行 $n$ 个正整数 $a_1,a_2,\cdots,a_n$，两个正整数之间以一个空格隔开。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>$T$ 行，每行一个非负整数表示答案。</p>
<h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><pre><code>3
3
1 2 3
4
1 2 1 2
4
4 4 4 4
</code></pre>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><pre><code>1
3
9
</code></pre>
<h3 id="样例解释"><a href="#样例解释" class="headerlink" title="样例解释"></a>样例解释</h3><p>对于第一组数据，由于点的颜色互不相同，故不能连边，而不连边时交点数为 $0$，故答案为 $1$。</p>
<p>对于第二组数据，有 $4$ 个匹配，其中 $(1,3),(2,4)$ 全连的匹配的交点数为 $1$ 不合法，故答案为 $3$。</p>
<p>对于第三组数据，连 $0$ 条边或 $1$ 条边都是合法的，而若连两条边则连 $(1,3),(2,4)$ 是不合法的，故答案为 $9$。</p>
<h3 id="数据范围"><a href="#数据范围" class="headerlink" title="数据范围"></a>数据范围</h3><p>对于数据点 $1\sim 2$，$n\le 13$。</p>
<p>对于数据点 $3\sim 4$，$a_i$ 是全部相同的。</p>
<p>对于数据点 $5\sim 10$，$a_i\le 10$。</p>
<p>对于数据点 $11\sim 14$，$n\le 300$。</p>
<p>对于数据点 $15\sim 20$，$n\le 2000$。</p>
<p>对 $100%$ 的数据，$1\le T\le 5, 1\le n\le 2000, 1\le a_i\le n$。</p>
